<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>MEM52220 - Applied Econometrics</title>
  <meta name="description" content="This manual constitutues the classroom material of the applied econometrics course at Tallinn University of Technology">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="MEM52220 - Applied Econometrics" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This manual constitutues the classroom material of the applied econometrics course at Tallinn University of Technology" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="MEM52220 - Applied Econometrics" />
  
  <meta name="twitter:description" content="This manual constitutues the classroom material of the applied econometrics course at Tallinn University of Technology" />
  

<meta name="author" content="Nicolas Reigl">


<meta name="date" content="2018-08-25">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="linearregression.html">
<link rel="next" href="references.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">MEM5220 - Applied Econometrics</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i>Prerequisites</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#installation-of-r-and-rstudio"><i class="fa fa-check"></i>Installation of R and RStudio</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#resources"><i class="fa fa-check"></i>Resources</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#attribution"><i class="fa fa-check"></i>Attribution</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#software-information-and-conventions"><i class="fa fa-check"></i>Software information and conventions</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="linearregression.html"><a href="linearregression.html"><i class="fa fa-check"></i><b>1</b> Linear Regression</a><ul>
<li class="chapter" data-level="1.1" data-path="linearregression.html"><a href="linearregression.html#simple-linear-regression"><i class="fa fa-check"></i><b>1.1</b> Simple Linear Regression</a><ul>
<li class="chapter" data-level="1.1.1" data-path="linearregression.html"><a href="linearregression.html#regression-through-the-origin-and-regression-on-a-constant"><i class="fa fa-check"></i><b>1.1.1</b> Regression through the Origin and Regression on a Constant</a></li>
<li class="chapter" data-level="1.1.2" data-path="linearregression.html"><a href="linearregression.html#simulating-slr"><i class="fa fa-check"></i><b>1.1.2</b> Simulating SLR</a></li>
<li class="chapter" data-level="1.1.3" data-path="linearregression.html"><a href="linearregression.html#nonlinearities"><i class="fa fa-check"></i><b>1.1.3</b> Nonlinearities</a></li>
<li class="chapter" data-level="1.1.4" data-path="linearregression.html"><a href="linearregression.html#inference-for-simple-linear-regression"><i class="fa fa-check"></i><b>1.1.4</b> Inference for Simple Linear Regression</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="linearregression.html"><a href="linearregression.html#multiple-linear-regression"><i class="fa fa-check"></i><b>1.2</b> Multiple Linear Regression</a><ul>
<li class="chapter" data-level="1.2.1" data-path="linearregression.html"><a href="linearregression.html#ceteris-paribus-interpretation-and-omitted-variable-bias"><i class="fa fa-check"></i><b>1.2.1</b> Ceteris Paribus Interpretation and Omitted Variable bias</a></li>
<li class="chapter" data-level="1.2.2" data-path="linearregression.html"><a href="linearregression.html#standard-errors-multicollinearity-and-vif"><i class="fa fa-check"></i><b>1.2.2</b> Standard errors, Multicollinearity and VIF</a></li>
<li class="chapter" data-level="1.2.3" data-path="linearregression.html"><a href="linearregression.html#multiple-regression-analysis-ols-asymptotics"><i class="fa fa-check"></i><b>1.2.3</b> Multiple Regression Analysis: OLS Asymptotics</a></li>
<li class="chapter" data-level="1.2.4" data-path="linearregression.html"><a href="linearregression.html#reporting-regression-results"><i class="fa fa-check"></i><b>1.2.4</b> Reporting Regression Results</a></li>
<li class="chapter" data-level="1.2.5" data-path="linearregression.html"><a href="linearregression.html#model-formulae"><i class="fa fa-check"></i><b>1.2.5</b> Model Formulae</a></li>
<li class="chapter" data-level="1.2.6" data-path="linearregression.html"><a href="linearregression.html#mlr-prediction"><i class="fa fa-check"></i><b>1.2.6</b> MLR Prediction</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="linearregression.html"><a href="linearregression.html#mlr-analysis-with-qualitative-regressors"><i class="fa fa-check"></i><b>1.3</b> MLR Analysis with Qualitative Regressors</a><ul>
<li class="chapter" data-level="1.3.1" data-path="linearregression.html"><a href="linearregression.html#dummy-variabes"><i class="fa fa-check"></i><b>1.3.1</b> Dummy variabes</a></li>
<li class="chapter" data-level="1.3.2" data-path="linearregression.html"><a href="linearregression.html#logical-variables"><i class="fa fa-check"></i><b>1.3.2</b> Logical variables</a></li>
<li class="chapter" data-level="1.3.3" data-path="linearregression.html"><a href="linearregression.html#factor-variables"><i class="fa fa-check"></i><b>1.3.3</b> Factor variables</a></li>
<li class="chapter" data-level="1.3.4" data-path="linearregression.html"><a href="linearregression.html#interactions-and-differences-in-regression-functions-across-groups"><i class="fa fa-check"></i><b>1.3.4</b> Interactions and differences in regression functions across groups</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="linearregression.html"><a href="linearregression.html#heteroskedasticity"><i class="fa fa-check"></i><b>1.4</b> Heteroskedasticity</a><ul>
<li class="chapter" data-level="1.4.1" data-path="linearregression.html"><a href="linearregression.html#spotting-heteroskedasticity-in-scatter-plots"><i class="fa fa-check"></i><b>1.4.1</b> Spotting Heteroskedasticity in Scatter Plots</a></li>
<li class="chapter" data-level="1.4.2" data-path="linearregression.html"><a href="linearregression.html#heteroskedasticity-tests"><i class="fa fa-check"></i><b>1.4.2</b> Heteroskedasticity Tests</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="linearregression.html"><a href="linearregression.html#weighted-least-squares"><i class="fa fa-check"></i><b>1.5</b> Weighted least squares</a></li>
<li class="chapter" data-level="1.6" data-path="linearregression.html"><a href="linearregression.html#model-specification-and-parameter-heterogeneity"><i class="fa fa-check"></i><b>1.6</b> Model specification and Parameter Heterogeneity</a><ul>
<li class="chapter" data-level="1.6.1" data-path="linearregression.html"><a href="linearregression.html#functional-form-misspecifcation"><i class="fa fa-check"></i><b>1.6.1</b> Functional Form Misspecifcation</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="linearregression.html"><a href="linearregression.html#least-absolute-deviations-lad-estimation"><i class="fa fa-check"></i><b>1.7</b> Least absolute Deviations (LAD) Estimation</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="binarymodels.html"><a href="binarymodels.html"><i class="fa fa-check"></i><b>2</b> Qualitative and LDV Models</a><ul>
<li class="chapter" data-level="2.1" data-path="binarymodels.html"><a href="binarymodels.html#linear-probability-models"><i class="fa fa-check"></i><b>2.1</b> Linear probability models</a></li>
<li class="chapter" data-level="2.2" data-path="binarymodels.html"><a href="binarymodels.html#logit-and-probit-models-estimation"><i class="fa fa-check"></i><b>2.2</b> Logit and Probit Models: Estimation</a><ul>
<li class="chapter" data-level="2.2.1" data-path="binarymodels.html"><a href="binarymodels.html#multinomial-logit"><i class="fa fa-check"></i><b>2.2.1</b> Multinomial Logit</a></li>
<li class="chapter" data-level="2.2.2" data-path="binarymodels.html"><a href="binarymodels.html#the-conditional-logit-model"><i class="fa fa-check"></i><b>2.2.2</b> The Conditional Logit Model</a></li>
<li class="chapter" data-level="2.2.3" data-path="binarymodels.html"><a href="binarymodels.html#ordered-choice-models"><i class="fa fa-check"></i><b>2.2.3</b> Ordered Choice Models</a></li>
<li class="chapter" data-level="2.2.4" data-path="binarymodels.html"><a href="binarymodels.html#probit-model"><i class="fa fa-check"></i><b>2.2.4</b> Probit model</a></li>
<li class="chapter" data-level="2.2.5" data-path="binarymodels.html"><a href="binarymodels.html#inference"><i class="fa fa-check"></i><b>2.2.5</b> Inference</a></li>
<li class="chapter" data-level="2.2.6" data-path="binarymodels.html"><a href="binarymodels.html#predictions"><i class="fa fa-check"></i><b>2.2.6</b> Predictions</a></li>
<li class="chapter" data-level="2.2.7" data-path="binarymodels.html"><a href="binarymodels.html#marginal-partial-effects"><i class="fa fa-check"></i><b>2.2.7</b> Marginal (partial) effects</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="binarymodels.html"><a href="binarymodels.html#count-data-the-poisson-regression-model"><i class="fa fa-check"></i><b>2.3</b> Count data: The Poisson Regression Model</a><ul>
<li class="chapter" data-level="2.3.1" data-path="binarymodels.html"><a href="binarymodels.html#corner-solution-response-the-tobit-model"><i class="fa fa-check"></i><b>2.3.1</b> Corner Solution Response: The Tobit Model</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="binarymodels.html"><a href="binarymodels.html#censored-and-truncated-regression-models"><i class="fa fa-check"></i><b>2.4</b> Censored and Truncated Regression Models</a><ul>
<li class="chapter" data-level="2.4.1" data-path="binarymodels.html"><a href="binarymodels.html#the-heckman-or-sample-selection-model"><i class="fa fa-check"></i><b>2.4.1</b> The Heckman, or Sample Selection Model</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">MEM52220 - Applied Econometrics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="binarymodels" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Qualitative and LDV Models</h1>
<p>To load the dataset and necessary functions:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># This function 1. checks if the packages are installed. 2. It installs the packages if they were not in the list of installed packages. 3. It loads the packages into the workspace</span>
devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;ccolonescu/PoEdata&quot;</span>)
PACKAGES&lt;-<span class="kw">c</span>(
            <span class="st">&quot;tidyverse&quot;</span>,  <span class="co"># for data manipulation and ggplots</span>
            <span class="st">&quot;broom&quot;</span>,  <span class="co"># Tidy regression output</span>
            <span class="st">&quot;car&quot;</span>, <span class="co"># Companion to applied regression</span>
            <span class="st">&quot;knitr&quot;</span>, <span class="co"># knit functions</span>
            <span class="co"># &quot;kableExtra&quot;, # extended knit functions for objects exported from other packages</span>
            <span class="st">&quot;huxtable&quot;</span>, <span class="co">#  Regression tables, broom compatible</span>
            <span class="st">&quot;stargazer&quot;</span>, <span class="co"># Regression tables</span>
            <span class="st">&quot;AER&quot;</span>, <span class="co">#  Functions, data sets, examples, demos, and vignettes for the book Christian Kleiber and Achim Zeileis (2008)</span>
            <span class="st">&quot;PoEdata&quot;</span>, <span class="co"># R data sets for &quot;Principles of Econometrics&quot; by Hill, Griffiths, and Lim, 4e, Wiley. https://github.com/ccolonescu/PoEdata</span>
            <span class="st">&quot;wooldridge&quot;</span>,  <span class="co"># Wooldrige Datasets</span>
            <span class="st">&quot;MCMCpack&quot;</span>, <span class="co"># Contains functions to perform Bayesian inference using posterior simulation for a number of ssatistical models.</span>
            <span class="st">&quot;sampleSelection&quot;</span>, <span class="co"># Two-step and maximum likelihood estimation of Heckman-type sample selection models</span>
            <span class="st">&quot;scales&quot;</span>, <span class="co"># scale helper functions such as percent </span>
            <span class="st">&quot;lmtest&quot;</span>, 
            <span class="st">&quot;margins&quot;</span>, <span class="co"># Stata like margin functions</span>
            <span class="st">&quot;prediction&quot;</span>, <span class="co"># Type stable predictions</span>
            <span class="st">&quot;nnet&quot;</span>, <span class="co"># Multinomial logit</span>
            <span class="st">&quot;survival&quot;</span>, <span class="co"># Survival Analysis</span>
            <span class="st">&quot;sampleSelection&quot;</span>, <span class="co"># Heckman type sample selection</span>
            <span class="st">&quot;censReg&quot;</span>, <span class="co"># Censored Regression models</span>
            <span class="st">&quot;magrittr&quot;</span>) <span class="co">#  pipes</span>
inst&lt;-<span class="kw">match</span>(PACKAGES, <span class="kw">.packages</span>(<span class="dt">all=</span><span class="ot">TRUE</span>))
need&lt;-<span class="kw">which</span>(<span class="kw">is.na</span>(inst))
<span class="cf">if</span> (<span class="kw">length</span>(need)<span class="op">&gt;</span><span class="dv">0</span>) <span class="kw">install.packages</span>(PACKAGES[need])
<span class="kw">lapply</span>(PACKAGES, require, <span class="dt">character.only=</span>T)</code></pre>
<p>Binary dependent variables are frequently studied in applied economics. Because a dummy variable <span class="math inline">\(y\)</span> can only take values 0 and 1, its (conditional) expected value is equal to the (conditional) probability that <span class="math inline">\(y=1\)</span>:</p>
<p><span class="math inline">\(E(y|x) = 0 \times P(y = 0|x) + 1 \times P(y = 1|x) = P(y=1|x)\)</span></p>
<p>An important class of models specifies the success probability as</p>
<p><span class="math inline">\(P(y = 1 | x) = G(\beta_0 + \beta_1 + \dots \beta_k x_k) = G(\boldsymbol{x} \boldsymbol{\beta})\)</span></p>
<p>The following table is taken from <span class="citation">Dalpiaz (<a href="#ref-dalpiaz2016">2016</a>)</span> and summarizes three examples of a generalized linear model:</p>
<table>
<colgroup>
<col width="22%" />
<col width="23%" />
<col width="26%" />
<col width="27%" />
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>Linear Regression</th>
<th>Poisson Regression</th>
<th>Logistic Regression</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(Y \mid {\bf X} = {\bf x}\)</span></td>
<td><span class="math inline">\(N(\mu({\bf x}), \sigma^2)\)</span></td>
<td><span class="math inline">\(\text{Pois}(\lambda({\bf x}))\)</span></td>
<td><span class="math inline">\(\text{Bern}(p({\bf x}))\)</span></td>
</tr>
<tr class="even">
<td><strong>Distribution Name</strong></td>
<td>Normal</td>
<td>Poisson</td>
<td>Bernoulli (Binomial)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\text{E}[Y \mid {\bf X} = {\bf x}]\)</span></td>
<td><span class="math inline">\(\mu({\bf x})\)</span></td>
<td><span class="math inline">\(\lambda({\bf x})\)</span></td>
<td><span class="math inline">\(p({\bf x})\)</span></td>
</tr>
<tr class="even">
<td><strong>Support</strong></td>
<td>Real: <span class="math inline">\((-\infty, \infty)\)</span></td>
<td>Integer: <span class="math inline">\(0, 1, 2, \ldots\)</span></td>
<td>Integer: <span class="math inline">\(0, 1\)</span></td>
</tr>
<tr class="odd">
<td><strong>Usage</strong></td>
<td>Numeric Data</td>
<td>Count (Integer) Data</td>
<td>Binary (Class ) Data</td>
</tr>
<tr class="even">
<td><strong>Link Name</strong></td>
<td>Identity</td>
<td>Log</td>
<td>Logit</td>
</tr>
<tr class="odd">
<td><strong>Link Function</strong></td>
<td><span class="math inline">\(\eta({\bf x}) = \mu({\bf x})\)</span></td>
<td><span class="math inline">\(\eta({\bf x}) = \log(\lambda({\bf x}))\)</span></td>
<td><span class="math inline">\(\eta({\bf x}) = \log \left(\frac{p({\bf x})}{1 - p({\bf x})} \right)\)</span></td>
</tr>
<tr class="even">
<td><strong>Mean Function</strong></td>
<td><span class="math inline">\(\mu({\bf x}) = \eta({\bf x})\)</span></td>
<td><span class="math inline">\(\lambda({\bf x}) = e^{\eta({\bf x})}\)</span></td>
<td><span class="math inline">\(p({\bf x}) = \frac{e^{\eta({\bf x})}}{1 + e^{\eta({\bf x})}} = \frac{1}{1 + e^{-\eta({\bf x})}}\)</span></td>
</tr>
</tbody>
</table>
<p>Like ordinary linear regression, we will seek to “fit” the model by estimating the <span class="math inline">\(\beta\)</span> parameters. To do so, we will use the method of maximum likelihood.</p>
<p>Note that a Bernoulli distribution is a specific case of a binomial distribution where the <span class="math inline">\(n\)</span> parameter of a binomial is <span class="math inline">\(1\)</span>. Binomial regression is also possible, but we’ll focus on the much more popular Bernoulli case.</p>
<p>So, in general, GLMs relate the mean of the response to a linear combination of the predictors, <span class="math inline">\(\eta({\bf x})\)</span>, through the use of a link function, <span class="math inline">\(g()\)</span>. That is,</p>
<p><span class="math display">\[
\eta({\bf x}) = g\left(\text{E}[Y \mid {\bf X} = {\bf x}]\right).
\]</span></p>
<p>The mean is then</p>
<p><span class="math display">\[
\text{E}[Y \mid {\bf X} = {\bf x}] = g^{-1}(\eta({\bf x})).
\]</span></p>
<div id="linear-probability-models" class="section level2">
<h2><span class="header-section-number">2.1</span> Linear probability models</h2>
<p>If a dummy variable is used as the dependent variable <span class="math inline">\(y\)</span>, we can still use OLS to estimate its relation to the regressors <span class="math inline">\(x\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;mroz&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;wooldridge&quot;</span>)
<span class="co"># Estimate linear probability model</span>
linprob &lt;-<span class="st"> </span><span class="kw">lm</span>(inlf<span class="op">~</span>nwifeinc<span class="op">+</span>educ<span class="op">+</span>exper<span class="op">+</span><span class="kw">I</span>(exper<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span>age<span class="op">+</span>kidslt6<span class="op">+</span>kidsge6,<span class="dt">data=</span>mroz)
<span class="co"># Regression table with heteroscedasticity-robust SE and t tests:</span>
<span class="kw">coeftest</span>(linprob,<span class="dt">vcov=</span>hccm)</code></pre>
<pre><code>## 
## t test of coefficients:
## 
##                Estimate  Std. Error t value  Pr(&gt;|t|)    
## (Intercept)  0.58551922  0.15358032  3.8125  0.000149 ***
## nwifeinc    -0.00340517  0.00155826 -2.1852  0.029182 *  
## educ         0.03799530  0.00733982  5.1766 2.909e-07 ***
## exper        0.03949239  0.00598359  6.6001 7.800e-11 ***
## I(exper^2)  -0.00059631  0.00019895 -2.9973  0.002814 ** 
## age         -0.01609081  0.00241459 -6.6640 5.183e-11 ***
## kidslt6     -0.26181047  0.03215160 -8.1430 1.621e-15 ***
## kidsge6      0.01301223  0.01366031  0.9526  0.341123    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>The estimated coefficient <em>educ</em> can be interpreted as: an additional year of schooling increases the probability that a woman is in the labor force <em>ceteris paribus</em> by 3.80%.</p>
<p>One problem with linear probability models is that <span class="math inline">\(P(y=1|x)\)</span> is specified as a linear function of the regressors. By construction, there are more or less realistic combinations of regressor values that yield <span class="math inline">\(\hat{y} &lt; 0\)</span> or <span class="math inline">\(\hat{y} &gt; 1\)</span>.</p>
</div>
<div id="logit-and-probit-models-estimation" class="section level2">
<h2><span class="header-section-number">2.2</span> Logit and Probit Models: Estimation</h2>
<p>For binary response models, the most widely used specification for G are</p>
<ul>
<li>the <strong>probit</strong> model with <span class="math inline">\(G(z) = \phi(z)\)</span>, the standard cdf and</li>
<li>the <strong>logit</strong> model with <span class="math inline">\(G(z) = \Lambda(z) = \frac{exp(z)}{1+ exp(z)}\)</span>, the cdf of the logistic distribution.</li>
</ul>
<p>In R many generalized linear models can be estimated by the <code>glm()</code> command. It accepts the additional option</p>
<ul>
<li><code>family = binomial (link = logit)</code> for the logit model or</li>
<li><code>family = binomial (link = probit)</code> for the probit model</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Estimate logit model</span>
logitres&lt;-<span class="kw">glm</span>(inlf<span class="op">~</span>nwifeinc<span class="op">+</span>educ<span class="op">+</span>exper<span class="op">+</span><span class="kw">I</span>(exper<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span>age<span class="op">+</span>kidslt6<span class="op">+</span>kidsge6,
              <span class="dt">family=</span><span class="kw">binomial</span>(<span class="dt">link=</span>logit),<span class="dt">data=</span>mroz)
<span class="co"># Summary of results:</span>
<span class="kw">summary</span>(logitres)</code></pre>
<pre><code>## 
## Call:
## glm(formula = inlf ~ nwifeinc + educ + exper + I(exper^2) + age + 
##     kidslt6 + kidsge6, family = binomial(link = logit), data = mroz)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.1770  -0.9063   0.4473   0.8561   2.4032  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  0.425452   0.860365   0.495  0.62095    
## nwifeinc    -0.021345   0.008421  -2.535  0.01126 *  
## educ         0.221170   0.043439   5.091 3.55e-07 ***
## exper        0.205870   0.032057   6.422 1.34e-10 ***
## I(exper^2)  -0.003154   0.001016  -3.104  0.00191 ** 
## age         -0.088024   0.014573  -6.040 1.54e-09 ***
## kidslt6     -1.443354   0.203583  -7.090 1.34e-12 ***
## kidsge6      0.060112   0.074789   0.804  0.42154    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1029.75  on 752  degrees of freedom
## Residual deviance:  803.53  on 745  degrees of freedom
## AIC: 819.53
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Log likelihood value:</span>
<span class="kw">logLik</span>(logitres) </code></pre>
<pre><code>## &#39;log Lik.&#39; -401.7652 (df=8)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># McFadden&#39;s pseudo R2:</span>
<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>logitres<span class="op">$</span>deviance<span class="op">/</span>logitres<span class="op">$</span>null.deviance</code></pre>
<pre><code>## [1] 0.2196814</code></pre>
<div id="multinomial-logit" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Multinomial Logit</h3>
<p>A relatively common R function that fits multinomial logit models is <code>multinom()</code> from package <strong>nnet</strong>. Let us use the dataset <em>nels_small</em> for an example of how multinom works. The variable grades in this dataset is an index, with best grades represented by lower values of grade. We try to explain the choice of a secondary institution (psechoice) only by the high school grade. The variable pschoice</p>
<p>can take one of three values:</p>
<ul>
<li>psechoice = 1 no college,</li>
<li>psechoice = 2 two year college</li>
<li>psechoice = 3 four year college</li>
</ul>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;nels_small&quot;</span>, <span class="dt">package=</span><span class="st">&quot;PoEdata&quot;</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">nels.multinom &lt;-<span class="st"> </span><span class="kw">multinom</span>(psechoice<span class="op">~</span>grades, <span class="dt">data=</span>nels_small)</code></pre>
<pre><code>## # weights:  9 (4 variable)
## initial  value 1098.612289 
## iter  10 value 875.313116
## final  value 875.313099 
## converged</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(nels.multinom)</code></pre>
<pre><code>## Call:
## multinom(formula = psechoice ~ grades, data = nels_small)
## 
## Coefficients:
##   (Intercept)     grades
## 2    2.505273 -0.3086404
## 3    5.770170 -0.7062468
## 
## Std. Errors:
##   (Intercept)     grades
## 2   0.4183944 0.05228532
## 3   0.4043290 0.05292638
## 
## Residual Deviance: 1750.626 
## AIC: 1758.626</code></pre>
<p>The output from function multinom gives coefficient estimates for each level of the response variable psechoice, except for the first level, which is the benchmark.</p>
<pre class="sourceCode r"><code class="sourceCode r">medGrades &lt;-<span class="st"> </span><span class="kw">median</span>(nels_small<span class="op">$</span>grades)
fifthPercentileGrades &lt;-<span class="st"> </span><span class="kw">quantile</span>(nels_small<span class="op">$</span>grades, <span class="fl">.05</span>)
newdat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">grades=</span><span class="kw">c</span>(medGrades, fifthPercentileGrades))
pred &lt;-<span class="st"> </span><span class="kw">predict</span>(nels.multinom, newdat, <span class="st">&quot;probs&quot;</span>)
pred</code></pre>
<pre><code>##             1          2         3
##    0.18101808 0.28557312 0.5334088
## 5% 0.01781764 0.09662199 0.8855604</code></pre>
</div>
<div id="the-conditional-logit-model" class="section level3">
<h3><span class="header-section-number">2.2.2</span> The Conditional Logit Model</h3>
<p>In the multinomial logit model all individuals faced the same external conditions and each individual’s choice is only determined by an individual’s circumstances or preferences. The conditional logit model allows for individuals to face individual-specific external conditions, such as the price of a product.</p>
<p>Suppose we want to study the effect of price on an individual’s decision about choosing one of three brands of soft drinks:</p>
<ul>
<li>pepsi</li>
<li>sevenup</li>
<li>coke</li>
</ul>
<p>R offers several alternatives that allow fitting conditional logit models, one of which is the function <code>MCMCmnl()</code> from the package <strong>MCMCpack</strong> (others are, for instance, <code>clogit()</code> in the <strong>survival</strong> package and <code>mclogit()</code> in the <strong>mclogit</strong> package). The following code is adapted from <span class="citation">Adkins (<a href="#ref-Adkins2014">2014</a>)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;cola&quot;</span>, <span class="dt">package=</span><span class="st">&quot;PoEdata&quot;</span>)
N &lt;-<span class="st"> </span><span class="kw">nrow</span>(cola)
N3 &lt;-<span class="st"> </span>N<span class="op">/</span><span class="dv">3</span>
price1 &lt;-<span class="st"> </span>cola<span class="op">$</span>price[<span class="kw">seq</span>(<span class="dv">1</span>,N,<span class="dt">by=</span><span class="dv">3</span>)]
price2 &lt;-<span class="st"> </span>cola<span class="op">$</span>price[<span class="kw">seq</span>(<span class="dv">2</span>,N,<span class="dt">by=</span><span class="dv">3</span>)]
price3 &lt;-<span class="st"> </span>cola<span class="op">$</span>price[<span class="kw">seq</span>(<span class="dv">3</span>,N,<span class="dt">by=</span><span class="dv">3</span>)]

bchoice &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="st">&quot;1&quot;</span>, N3)
<span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N3){
  <span class="cf">if</span>(cola<span class="op">$</span>choice[<span class="dv">3</span><span class="op">*</span>j<span class="dv">-1</span>]<span class="op">==</span><span class="dv">1</span>) bchoice[j] &lt;-<span class="st"> &quot;2&quot;</span>
  <span class="cf">if</span>(cola<span class="op">$</span>choice[<span class="dv">3</span><span class="op">*</span>j]<span class="op">==</span><span class="dv">1</span>) bchoice[j] &lt;-<span class="st"> &quot;3&quot;</span>
}
cola.clogit &lt;-<span class="st"> </span><span class="kw">MCMCmnl</span>(bchoice <span class="op">~</span>
<span class="st">                         </span><span class="kw">choicevar</span>(price1, <span class="st">&quot;b2&quot;</span>, <span class="st">&quot;1&quot;</span>)<span class="op">+</span>
<span class="st">                         </span><span class="kw">choicevar</span>(price2, <span class="st">&quot;b2&quot;</span>, <span class="st">&quot;2&quot;</span>)<span class="op">+</span>
<span class="st">                         </span><span class="kw">choicevar</span>(price3, <span class="st">&quot;b2&quot;</span>, <span class="st">&quot;3&quot;</span>),
                       <span class="dt">baseline=</span><span class="st">&quot;3&quot;</span>, <span class="dt">mcmc.method=</span><span class="st">&quot;IndMH&quot;</span>)</code></pre>
<pre><code>## Calculating MLEs and large sample var-cov matrix.
## This may take a moment...
## Inverting Hessian to get large sample var-cov matrix.</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">sclogit &lt;-<span class="st"> </span><span class="kw">summary</span>(cola.clogit)
tabMCMC &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(sclogit<span class="op">$</span>statistics)[,<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]
<span class="kw">row.names</span>(tabMCMC)&lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;b2&quot;</span>,<span class="st">&quot;b11&quot;</span>,<span class="st">&quot;b12&quot;</span>)
<span class="kw">kable</span>(tabMCMC, <span class="dt">digits=</span><span class="dv">4</span>, <span class="dt">align=</span><span class="st">&quot;c&quot;</span>,
      <span class="dt">caption=</span><span class="st">&quot;Conditional logit estimates for the &#39;cola&#39; problem&quot;</span>)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-142">Table 2.1: </span>Conditional logit estimates for the ‘cola’ problem</caption>
<thead>
<tr class="header">
<th></th>
<th align="center">Mean</th>
<th align="center">SD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>b2</td>
<td align="center">-2.2991</td>
<td align="center">0.1382</td>
</tr>
<tr class="even">
<td>b11</td>
<td align="center">0.2839</td>
<td align="center">0.0610</td>
</tr>
<tr class="odd">
<td>b12</td>
<td align="center">0.1037</td>
<td align="center">0.0621</td>
</tr>
</tbody>
</table>
</div>
<div id="ordered-choice-models" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Ordered Choice Models</h3>
<p>The order of choices in these models is meaningful, unlike the multinomial and conditional logit model we have studied so far. The following example explains the choice of higher education, when the choice variable is psechoice and the only regressor is grades; the dataset, <em>nels_small</em> , is already known to us.</p>
<p>The R package <strong>MCMCpack</strong> is again used here, with its function <code>MCMCoprobit()</code>.</p>
<pre class="sourceCode r"><code class="sourceCode r">nels.oprobit &lt;-<span class="st"> </span><span class="kw">MCMCoprobit</span>(psechoice <span class="op">~</span><span class="st"> </span>grades, 
                            <span class="dt">data=</span>nels_small, <span class="dt">mcmc=</span><span class="dv">10000</span>)
sOprobit &lt;-<span class="st"> </span><span class="kw">summary</span>(nels.oprobit)
tabOprobit &lt;-<span class="st"> </span>sOprobit<span class="op">$</span>statistics[, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]
<span class="kw">kable</span>(tabOprobit, <span class="dt">digits=</span><span class="dv">4</span>, <span class="dt">align=</span><span class="st">&quot;c&quot;</span>,
      <span class="dt">caption=</span><span class="st">&quot;Ordered probit estimates for the &#39;nels&#39; problem&quot;</span>)</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-143">Table 2.2: </span>Ordered probit estimates for the ‘nels’ problem</caption>
<thead>
<tr class="header">
<th></th>
<th align="center">Mean</th>
<th align="center">SD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>(Intercept)</td>
<td align="center">2.9542</td>
<td align="center">0.1478</td>
</tr>
<tr class="even">
<td>grades</td>
<td align="center">-0.3074</td>
<td align="center">0.0193</td>
</tr>
<tr class="odd">
<td>gamma2</td>
<td align="center">0.8616</td>
<td align="center">0.0487</td>
</tr>
</tbody>
</table>
<p>The results from MCMCoprobit can be translated into the textbook notations as follows:</p>
<ul>
<li><span class="math inline">\(\mu_1\)</span> =− (Intercept)</li>
<li><span class="math inline">\(\beta\)</span> = grades</li>
<li><span class="math inline">\(\mu_2\)</span> = gamma2 − (Intercept)</li>
</ul>
<p>The probabilities for each choice can be calculated as in the next code fragment:</p>
<pre class="sourceCode r"><code class="sourceCode r">mu1 &lt;-<span class="st"> </span><span class="op">-</span>tabOprobit[<span class="dv">1</span>]
b &lt;-<span class="st"> </span>tabOprobit[<span class="dv">2</span>]
mu2 &lt;-<span class="st"> </span>tabOprobit[<span class="dv">3</span>]<span class="op">-</span>tabOprobit[<span class="dv">1</span>]
xGrade &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(nels_small<span class="op">$</span>grades), 
            <span class="kw">quantile</span>(nels_small<span class="op">$</span>grades, <span class="fl">0.05</span>))

<span class="co"># Probabilities:</span>
prob1 &lt;-<span class="st"> </span><span class="kw">pnorm</span>(mu1<span class="op">-</span>b<span class="op">*</span>xGrade)
prob2 &lt;-<span class="st"> </span><span class="kw">pnorm</span>(mu2<span class="op">-</span>b<span class="op">*</span>xGrade)<span class="op">-</span><span class="kw">pnorm</span>(mu1<span class="op">-</span>b<span class="op">*</span>xGrade)
prob3 &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="kw">pnorm</span>(mu2<span class="op">-</span>b<span class="op">*</span>xGrade)

<span class="co"># Marginal effects:</span>
Dp1DGrades &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">pnorm</span>(mu1<span class="op">-</span>b<span class="op">*</span>xGrade)<span class="op">*</span>b
Dp2DGrades &lt;-<span class="st"> </span>(<span class="kw">pnorm</span>(mu1<span class="op">-</span>b<span class="op">*</span>xGrade)<span class="op">-</span><span class="kw">pnorm</span>(mu2<span class="op">-</span>b<span class="op">*</span>xGrade))<span class="op">*</span>b
Dp3DGrades &lt;-<span class="st"> </span><span class="kw">pnorm</span>(mu2<span class="op">-</span>b<span class="op">*</span>xGrade)<span class="op">*</span>b</code></pre>
<p>For instance, the marginal effect of grades on the probability of attending a four-year college for a student with average grade and for a student in the top 5 percent are, respectively, -0.143 and -0.031.</p>
</div>
<div id="probit-model" class="section level3">
<h3><span class="header-section-number">2.2.4</span> Probit model</h3>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">detach</span>(<span class="st">&quot;package:PoEdata&quot;</span>, <span class="dt">unload=</span><span class="ot">TRUE</span>)
<span class="kw">data</span>(<span class="st">&quot;mroz&quot;</span>, <span class="dt">package=</span><span class="st">&#39;wooldridge&#39;</span>)
<span class="kw">attach</span>(mroz)</code></pre>
<pre><code>## The following objects are masked from bwght:
## 
##     faminc, fatheduc, motheduc</code></pre>
<pre><code>## The following object is masked from gpa1:
## 
##     age</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Estimate probit model</span>
probitres&lt;-<span class="kw">glm</span>(inlf<span class="op">~</span>nwifeinc<span class="op">+</span>educ<span class="op">+</span>exper<span class="op">+</span><span class="kw">I</span>(exper<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span>age<span class="op">+</span>kidslt6<span class="op">+</span>kidsge6,
               <span class="dt">family=</span><span class="kw">binomial</span>(<span class="dt">link=</span>probit),<span class="dt">data=</span>mroz)
<span class="co"># Summary of results:</span>
<span class="kw">summary</span>(probitres)</code></pre>
<pre><code>## 
## Call:
## glm(formula = inlf ~ nwifeinc + educ + exper + I(exper^2) + age + 
##     kidslt6 + kidsge6, family = binomial(link = probit), data = mroz)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.2156  -0.9151   0.4315   0.8653   2.4553  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  0.2700736  0.5080782   0.532  0.59503    
## nwifeinc    -0.0120236  0.0049392  -2.434  0.01492 *  
## educ         0.1309040  0.0253987   5.154 2.55e-07 ***
## exper        0.1233472  0.0187587   6.575 4.85e-11 ***
## I(exper^2)  -0.0018871  0.0005999  -3.145  0.00166 ** 
## age         -0.0528524  0.0084624  -6.246 4.22e-10 ***
## kidslt6     -0.8683247  0.1183773  -7.335 2.21e-13 ***
## kidsge6      0.0360056  0.0440303   0.818  0.41350    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1029.7  on 752  degrees of freedom
## Residual deviance:  802.6  on 745  degrees of freedom
## AIC: 818.6
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Log likelihood value:</span>
<span class="kw">logLik</span>(probitres) </code></pre>
<pre><code>## &#39;log Lik.&#39; -401.3022 (df=8)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># McFadden&#39;s pseudo R2:</span>
<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>probitres<span class="op">$</span>deviance<span class="op">/</span>probitres<span class="op">$</span>null.deviance</code></pre>
<pre><code>## [1] 0.2205805</code></pre>
<p>Take a boostrap sample for the 95% confidence interval for each parameter.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;mroz&quot;</span>, <span class="dt">package=</span><span class="st">&#39;wooldridge&#39;</span>)

boot_probitres &lt;-<span class="st"> </span>mroz <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">bootstrap</span>(<span class="dv">500</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">do</span>(<span class="kw">tidy</span>(<span class="kw">glm</span>(inlf<span class="op">~</span>nwifeinc<span class="op">+</span>educ<span class="op">+</span>exper<span class="op">+</span><span class="kw">I</span>(exper<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span>age<span class="op">+</span>kidslt6<span class="op">+</span>kidsge6,
               <span class="dt">family=</span><span class="kw">binomial</span>(<span class="dt">link=</span>probit),.)))
boot_probitres <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">group_by</span>(term) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">low =</span> <span class="kw">quantile</span>(estimate, <span class="fl">.025</span>), 
                   <span class="dt">high =</span> <span class="kw">quantile</span>(estimate, <span class="fl">.0975</span>))</code></pre>
<table class="huxtable" style="border-collapse: collapse; margin-bottom: 2em; margin-top: 2em; width: 56.6666666666667%; margin-left: 0%; margin-right: auto; ">
<col><col><col><tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid; border-width: 0.4pt 0pt 0.4pt 0.4pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">term</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">low</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0.4pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">high</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">(Intercept)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.27&nbsp;&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.27&nbsp;&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt;">age</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt;">-0.0529&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt;">-0.0529&nbsp;</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">educ</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.131&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.131&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt;">exper</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt;">0.123&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt;">0.123&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">I(exper^2)</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-0.00189</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-0.00189</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt;">kidsge6</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt;">0.036&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt;">0.036&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">kidslt6</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-0.868&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-0.868&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0.4pt 0.4pt; padding: 4pt 4pt 4pt 4pt;">nwifeinc</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">-0.012&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">-0.012&nbsp;&nbsp;</td>
</tr>
</table>

</div>
<div id="inference" class="section level3">
<h3><span class="header-section-number">2.2.5</span> Inference</h3>
<p>We can implement the test for overall significance for the probit model using both manual and automatic calculations.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Test of overall significance:</span>
<span class="co"># Manual calculation of the LR test statistic:</span>
probitres<span class="op">$</span>null.deviance <span class="op">-</span><span class="st"> </span>probitres<span class="op">$</span>deviance</code></pre>
<pre><code>## [1] 227.142</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Automatic calculations including p-values,...:</span>
<span class="kw">lrtest</span>(probitres)</code></pre>
<table class="huxtable" style="border-collapse: collapse; margin-bottom: 2em; margin-top: 2em; width: 62.2222222222222%; margin-left: 0%; margin-right: auto; ">
<col><col><col><col><col><tr>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0pt 0.4pt 0.4pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">#Df</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">LogLik</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">Df</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">Chisq</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0.4pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">Pr(&gt;Chisq)</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">8</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-401</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);"></td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);"></td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0.4pt 0.4pt; padding: 4pt 4pt 4pt 4pt;">1</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">-515</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">-7</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">227</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">2.01e-45</td>
</tr>
</table>

<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Test of H0: experience and age are irrelevant</span>
restr &lt;-<span class="st"> </span><span class="kw">glm</span>(inlf<span class="op">~</span>nwifeinc<span class="op">+</span>educ<span class="op">+</span><span class="st"> </span>kidslt6<span class="op">+</span>kidsge6, 
             <span class="dt">family=</span><span class="kw">binomial</span>(<span class="dt">link=</span>logit),<span class="dt">data=</span>mroz)
<span class="kw">lrtest</span>(restr,probitres)</code></pre>
<table class="huxtable" style="border-collapse: collapse; margin-bottom: 2em; margin-top: 2em; width: 62.2222222222222%; margin-left: 0%; margin-right: auto; ">
<col><col><col><col><col><tr>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0pt 0.4pt 0.4pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">#Df</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">LogLik</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">Df</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">Chisq</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0.4pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">Pr(&gt;Chisq)</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">5</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-465</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);"></td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);"></td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0.4pt 0.4pt; padding: 4pt 4pt 4pt 4pt;">8</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">-401</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">3</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">127</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">2.12e-27</td>
</tr>
</table>

</div>
<div id="predictions" class="section level3">
<h3><span class="header-section-number">2.2.6</span> Predictions</h3>
<p>The command <code>predict()</code> can calculate predicted values for the estimation sample or arbitrary sets of regressor values.</p>
<p>We can calculate</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># predictions for two &quot;extreme&quot; women:</span>
xpred &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">nwifeinc=</span><span class="kw">c</span>(<span class="dv">100</span>,<span class="dv">0</span>),<span class="dt">educ=</span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">17</span>),<span class="dt">exper=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">30</span>),
              <span class="dt">age=</span><span class="kw">c</span>(<span class="dv">20</span>,<span class="dv">52</span>),<span class="dt">kidslt6=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">0</span>),<span class="dt">kidsge6=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>))
<span class="co"># Predictions from linear probability, probit and logit model:</span>
<span class="kw">predict</span>(linprob,  xpred,<span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</code></pre>
<pre><code>##          1          2 
## -0.4104582  1.0428084</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">predict</span>(logitres, xpred,<span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</code></pre>
<pre><code>##           1           2 
## 0.005218002 0.950049117</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">predict</span>(probitres,xpred,<span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</code></pre>
<pre><code>##           1           2 
## 0.001065043 0.959869044</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Simulated data</span>
<span class="kw">set.seed</span>(<span class="dv">12345</span>)
y &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">100</span>, <span class="dv">1</span>, <span class="fl">0.5</span>)
x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>) <span class="op">+</span><span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>y

<span class="co"># Estimation </span>
linpr.res &lt;-<span class="st"> </span><span class="kw">lm</span>(y<span class="op">~</span>x)
logit.res &lt;-<span class="kw">glm</span>(y <span class="op">~</span>x, <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> logit))
probit.res &lt;-<span class="kw">glm</span>(y <span class="op">~</span>x, <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="dt">link =</span> probit))

<span class="co"># Prediction from a regular grid of x values</span>
xp &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from=</span> <span class="kw">min</span>(x), <span class="dt">to=</span><span class="kw">max</span>(x), <span class="dt">length=</span><span class="dv">50</span>)
linpr.p &lt;-<span class="st"> </span><span class="kw">predict</span>(linpr.res, <span class="kw">list</span>(<span class="dt">x =</span> xp), <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)
logit.p &lt;-<span class="st"> </span><span class="kw">predict</span>(logit.res, <span class="kw">list</span>(<span class="dt">x =</span> xp), <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)
probit.p &lt;-<span class="st"> </span><span class="kw">predict</span>(probit.res, <span class="kw">list</span>(<span class="dt">x =</span> xp), <span class="dt">type =</span> <span class="st">&quot;response&quot;</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(x,y)
<span class="kw">lines</span>(xp, linpr.p, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">1</span>)
<span class="kw">lines</span>(xp, logit.p, <span class="dt">lwd=</span><span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">2</span>)
<span class="kw">lines</span>(xp, probit.p, <span class="dt">lwd=</span><span class="dv">1</span>, <span class="dt">lty =</span> <span class="dv">1</span>)
<span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, 
       <span class="kw">c</span>(<span class="st">&quot;linear prob.&quot;</span>, <span class="st">&quot;logit&quot;</span>, <span class="st">&quot;probit&quot;</span>), 
       <span class="dt">lwd =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>), <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>))</code></pre>
<div class="figure" style="text-align: center"><span id="fig:fig21"></span>
<img src="MEM5220_R_files/figure-html/fig21-1.png" alt="Predictions from binary response models (simulated data)" width="80%" />
<p class="caption">
Figure 2.1: Predictions from binary response models (simulated data)
</p>
</div>
</div>
<div id="marginal-partial-effects" class="section level3">
<h3><span class="header-section-number">2.2.7</span> Marginal (partial) effects</h3>
<p>Several packages provide estimates of marginal effects for different types of models. Among these are <strong>car</strong>, <strong>alr3</strong>, <strong>mfx</strong>, <strong>erer</strong>, among others. Unfortunately, none of these packages implement marginal effects correctly (i.e., correctly account for interrelated variables such as interaction terms (e.g., a:b) or power terms (e.g., I(a^2)) and the packages all implement quite different interfaces for different types of models. The <strong>margins</strong> and <strong>prediction</strong> packages are a combined effort to calculate marginal effects that include complex terms and provide a uniform interface for doing those calculations.</p>
<p>To know how much a variable influences the labour force participation, one has to use <code>margins()</code> command:</p>
<pre class="sourceCode r"><code class="sourceCode r">effects_logit_participation &lt;-<span class="st"> </span><span class="kw">margins</span>(logitres) 
<span class="kw">summary</span>(effects_logit_participation)</code></pre>
<table class="huxtable" style="border-collapse: collapse; margin-bottom: 2em; margin-top: 2em; width: 100%; margin-left: 0%; margin-right: auto; ">
<col><col><col><col><col><col><col><tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid; border-width: 0.4pt 0pt 0.4pt 0.4pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">factor</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">AME</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">SE</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">z</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">p</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">lower</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0.4pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">upper</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">age</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-0.0157&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.00238</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-6.6&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">4.04e-11</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-0.0204&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-0.0111&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt;">educ</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt;">0.0395&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt;">0.00729</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt;">5.41&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt;">6.15e-08</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt;">0.0252&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt;">0.0538&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">exper</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.0254&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.00224</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">11.4&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">5.99e-30</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.021&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.0298&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt;">kidsge6</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt;">0.0107&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt;">0.0133&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt;">0.805</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt;">0.421&nbsp;&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt;">-0.0154&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt;">0.0369&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">kidslt6</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-0.258&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.0319&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-8.07&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">7.05e-16</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-0.32&nbsp;&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-0.195&nbsp;&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0.4pt 0.4pt; padding: 4pt 4pt 4pt 4pt;">nwifeinc</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">-0.00381</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">0.00148</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">-2.57&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">0.0101&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">-0.00672</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">-0.000906</td>
</tr>
</table>

<p>If one desires subgroup effects, simply pass a subset of data to the data argument:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(<span class="kw">margins</span>(logitres, <span class="dt">data =</span> <span class="kw">subset</span>(mroz, kidslt6 <span class="op">==</span><span class="st"> </span><span class="dv">0</span>))) <span class="co"># no kids &lt; 6 years</span></code></pre>
<table class="huxtable" style="border-collapse: collapse; margin-bottom: 2em; margin-top: 2em; width: 100%; margin-left: 0%; margin-right: auto; ">
<col><col><col><col><col><col><col><tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid; border-width: 0.4pt 0pt 0.4pt 0.4pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">factor</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">AME</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">SE</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">z</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">p</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">lower</td>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0.4pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">upper</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">age</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-0.0156&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.00234</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-6.64&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">3.04e-11</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-0.0202&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-0.011&nbsp;&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt;">educ</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt;">0.0391&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt;">0.00726</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt;">5.39&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt;">7.13e-08</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt;">0.0249&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt;">0.0534&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">exper</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.0246&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.00212</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">11.6&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">4.23e-31</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.0204&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.0287&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt;">kidsge6</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt;">0.0106&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt;">0.0132&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt;">0.807</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt;">0.42&nbsp;&nbsp;&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt;">-0.0152&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt;">0.0365&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">kidslt6</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-0.255&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.033&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-7.73&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">1.09e-14</td>
<td style="vertical-align: top; text-align: right; white-space: normal; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-0.32&nbsp;&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0pt 0pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">-0.191&nbsp;&nbsp;&nbsp;</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: left; white-space: nowrap; border-style: solid; border-width: 0pt 0pt 0.4pt 0.4pt; padding: 4pt 4pt 4pt 4pt;">nwifeinc</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">-0.00378</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">0.00147</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">-2.57&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">0.0102&nbsp;&nbsp;</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">-0.00666</td>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0.4pt 0pt; padding: 4pt 4pt 4pt 4pt;">-0.000894</td>
</tr>
</table>

<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">summary</span>(effects_logit_participation)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(factor, AME)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> factor, <span class="dt">ymin =</span> lower, <span class="dt">ymax =</span> upper)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">color=</span><span class="st">&quot;lightgrey&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme_minimal</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>))</code></pre>
<div class="figure" style="text-align: center"><span id="fig:fig22"></span>
<img src="MEM5220_R_files/figure-html/fig22-1.png" alt="Logit effect plot" width="80%" />
<p class="caption">
Figure 2.2: Logit effect plot
</p>
</div>
<p>You can also extract the marginal effects of a single variable, with <code>dydx</code>:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(<span class="kw">dydx</span>(mroz, logitres, <span class="st">&quot;educ&quot;</span>))</code></pre>
<table class="huxtable" style="border-collapse: collapse; margin-bottom: 2em; margin-top: 2em; width: 20%; margin-left: 0%; margin-right: auto; ">
<col><tr>
<td style="vertical-align: top; text-align: right; white-space: nowrap; border-style: solid; border-width: 0.4pt 0.4pt 0.4pt 0.4pt; padding: 4pt 4pt 4pt 4pt; font-weight: bold;">dydx_educ</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.0464</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt;">0.0416</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.0463</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt;">0.0384</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0pt 0.4pt; padding: 4pt 4pt 4pt 4pt; background-color: rgb(242, 242, 242);">0.0538</td>
</tr>
<tr>
<td style="vertical-align: top; text-align: right; white-space: normal; border-style: solid; border-width: 0pt 0.4pt 0.4pt 0.4pt; padding: 4pt 4pt 4pt 4pt;">0.0335</td>
</tr>
</table>

<p>The function <code>cplot()</code> provides the commonly needed visual summaries of predictions or average marginal effects conditional on a covariate.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">cplot</span>(logitres, <span class="dt">x =</span> <span class="st">&quot;educ&quot;</span>, <span class="dt">se.type =</span> <span class="st">&quot;shade&quot;</span>)</code></pre>
<pre><code>##    xvals     yvals     upper     lower
## 1    5.0 0.2549509 0.3787666 0.1311353
## 2    5.5 0.2765192 0.3988913 0.1541471
## 3    6.0 0.2991794 0.4190899 0.1792689
## 4    6.5 0.3228678 0.4392936 0.2064421
## 5    7.0 0.3475019 0.4594481 0.2355556
## 6    7.5 0.3729801 0.4795186 0.2664417
## 7    8.0 0.3991836 0.4994946 0.2988726
## 8    8.5 0.4259774 0.5193953 0.3325594
## 9    9.0 0.4532129 0.5392750 0.3671508
## 10   9.5 0.4807315 0.5592299 0.4022331
## 11  10.0 0.5083674 0.5794045 0.4373304
## 12  10.5 0.5359524 0.5999963 0.4719084
## 13  11.0 0.5633190 0.6212490 0.5053891
## 14  11.5 0.5903055 0.6434188 0.5371922
## 15  12.0 0.6167588 0.6666929 0.5668248
## 16  12.5 0.6425384 0.6910722 0.5940047
## 17  13.0 0.6675187 0.7162931 0.6187444
## 18  13.5 0.6915913 0.7418704 0.6413122
## 19  14.0 0.7146659 0.7672368 0.6620950
## 20  14.5 0.7366715 0.7918749 0.6814681</code></pre>
<div class="figure" style="text-align: center"><span id="fig:fig23"></span>
<img src="MEM5220_R_files/figure-html/fig23-1.png" alt="Marginal effects for logit model" width="80%" />
<p class="caption">
Figure 2.3: Marginal effects for logit model
</p>
</div>
</div>
</div>
<div id="count-data-the-poisson-regression-model" class="section level2">
<h2><span class="header-section-number">2.3</span> Count data: The Poisson Regression Model</h2>
<p>Instead of just 0/1-coded binary data, count data can take any non-negative integer <span class="math inline">\(0, 1, 2, \dots\)</span>. If they take very large numbers (like the number of students in a school), they can be approximated reasonably well as contiouns variables in a linear models and estimated using OLS. If the numbers are relativly small, this approximation might not work well.</p>
<p>The Poisson regression model is the most basic and convenient model explicitly model explicitly designed for count data.</p>
<p>Poisson regression models can be estimated in R via the <code>glm()</code> function with the specification <strong>family= poisson</strong></p>
<p>Estimating the model with <strong>quasipoisson</strong> is to adjust for potential vioalations of the Poisson distribution.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(crime1, <span class="dt">package=</span><span class="st">&#39;wooldridge&#39;</span>)

<span class="co"># Estimate linear model</span>
lm.res      &lt;-<span class="st">  </span><span class="kw">lm</span>(narr86<span class="op">~</span>pcnv<span class="op">+</span>avgsen<span class="op">+</span>tottime<span class="op">+</span>ptime86<span class="op">+</span>qemp86<span class="op">+</span>inc86<span class="op">+</span>
<span class="st">                     </span>black<span class="op">+</span>hispan<span class="op">+</span>born60, <span class="dt">data=</span>crime1)
<span class="co"># Estimate Poisson model</span>
Poisson.res &lt;-<span class="st"> </span><span class="kw">glm</span>(narr86<span class="op">~</span>pcnv<span class="op">+</span>avgsen<span class="op">+</span>tottime<span class="op">+</span>ptime86<span class="op">+</span>qemp86<span class="op">+</span>inc86<span class="op">+</span>
<span class="st">                     </span>black<span class="op">+</span>hispan<span class="op">+</span>born60, <span class="dt">data=</span>crime1, <span class="dt">family=</span>poisson)
<span class="co"># Quasi-Poisson model</span>
QPoisson.res&lt;-<span class="st"> </span><span class="kw">glm</span>(narr86<span class="op">~</span>pcnv<span class="op">+</span>avgsen<span class="op">+</span>tottime<span class="op">+</span>ptime86<span class="op">+</span>qemp86<span class="op">+</span>inc86<span class="op">+</span>
<span class="st">                     </span>black<span class="op">+</span>hispan<span class="op">+</span>born60, <span class="dt">data=</span>crime1, <span class="dt">family=</span>quasipoisson)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stargazer</span>(lm.res,Poisson.res,QPoisson.res,<span class="dt">type=</span><span class="st">&quot;text&quot;</span>,<span class="dt">keep.stat=</span><span class="st">&quot;n&quot;</span>)</code></pre>
<pre><code>## 
## ==================================================
##                       Dependent variable:         
##              -------------------------------------
##                             narr86                
##                 OLS     Poisson  glm: quasipoisson
##                                     link = log    
##                 (1)       (2)           (3)       
## --------------------------------------------------
## pcnv         -0.132*** -0.402***     -0.402***    
##               (0.040)   (0.085)       (0.105)     
##                                                   
## avgsen        -0.011    -0.024        -0.024      
##               (0.012)   (0.020)       (0.025)     
##                                                   
## tottime        0.012    0.024*         0.024      
##               (0.009)   (0.015)       (0.018)     
##                                                   
## ptime86      -0.041*** -0.099***     -0.099***    
##               (0.009)   (0.021)       (0.025)     
##                                                   
## qemp86       -0.051***  -0.038        -0.038      
##               (0.014)   (0.029)       (0.036)     
##                                                   
## inc86        -0.001*** -0.008***     -0.008***    
##              (0.0003)   (0.001)       (0.001)     
##                                                   
## black        0.327***  0.661***      0.661***     
##               (0.045)   (0.074)       (0.091)     
##                                                   
## hispan       0.194***  0.500***      0.500***     
##               (0.040)   (0.074)       (0.091)     
##                                                   
## born60        -0.022    -0.051        -0.051      
##               (0.033)   (0.064)       (0.079)     
##                                                   
## Constant     0.577***  -0.600***     -0.600***    
##               (0.038)   (0.067)       (0.083)     
##                                                   
## --------------------------------------------------
## Observations   2,725     2,725         2,725      
## ==================================================
## Note:                  *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
<p>By construction, the parameter estiamtes are the same but the standard errors are larger for the QMLE.</p>
<div id="corner-solution-response-the-tobit-model" class="section level3">
<h3><span class="header-section-number">2.3.1</span> Corner Solution Response: The Tobit Model</h3>
<p>Corner solutions describe situations where the variable of interest is continous but restricted in range. Typically, it cannot be negative.</p>
<p>The package <strong>censReg</strong> offers the command <code>censReg()</code> for estimating a Tobit model.</p>
<p>We have already estimated labor supply mdoeld for the women in the dataset <em>mroz</em>, ignoring the fact that the hours worked is necessarily non-negative.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Estimate Tobit model using censReg:</span>
TobitRes &lt;-<span class="st"> </span><span class="kw">censReg</span>(hours<span class="op">~</span>nwifeinc<span class="op">+</span>educ<span class="op">+</span>exper<span class="op">+</span><span class="kw">I</span>(exper<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="st"> </span>
<span class="st">                      </span>age<span class="op">+</span>kidslt6<span class="op">+</span>kidsge6, <span class="dt">data=</span>mroz )
<span class="kw">summary</span>(TobitRes)</code></pre>
<pre><code>## 
## Call:
## censReg(formula = hours ~ nwifeinc + educ + exper + I(exper^2) + 
##     age + kidslt6 + kidsge6, data = mroz)
## 
## Observations:
##          Total  Left-censored     Uncensored Right-censored 
##            753            325            428              0 
## 
## Coefficients:
##               Estimate Std. error t value  Pr(&gt; t)    
## (Intercept)  965.30528  446.43613   2.162 0.030599 *  
## nwifeinc      -8.81424    4.45910  -1.977 0.048077 *  
## educ          80.64561   21.58324   3.736 0.000187 ***
## exper        131.56430   17.27939   7.614 2.66e-14 ***
## I(exper^2)    -1.86416    0.53766  -3.467 0.000526 ***
## age          -54.40501    7.41850  -7.334 2.24e-13 ***
## kidslt6     -894.02174  111.87803  -7.991 1.34e-15 ***
## kidsge6      -16.21800   38.64139  -0.420 0.674701    
## logSigma       7.02289    0.03706 189.514  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Newton-Raphson maximisation, 7 iterations
## Return code 1: gradient close to zero
## Log-likelihood: -3819.095 on 9 Df</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Partial Effects at the average x:</span>
<span class="kw">margEff</span>(TobitRes)</code></pre>
<pre><code>##    nwifeinc        educ       exper  I(exper^2)         age     kidslt6 
##   -5.326442   48.734094   79.504232   -1.126509  -32.876918 -540.256831 
##     kidsge6 
##   -9.800526</code></pre>
<p>Another alternative for estimating Tobit models is the command <strong>survreg</strong> from the package survival. It is less straightforward to use but more flexible.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Estimate Tobit model using survreg:</span>
res &lt;-<span class="st"> </span><span class="kw">survreg</span>(<span class="kw">Surv</span>(hours, hours<span class="op">&gt;</span><span class="dv">0</span>, <span class="dt">type=</span><span class="st">&quot;left&quot;</span>) <span class="op">~</span><span class="st"> </span>nwifeinc<span class="op">+</span>educ<span class="op">+</span>exper<span class="op">+</span>
<span class="st">                 </span><span class="kw">I</span>(exper<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span>age<span class="op">+</span>kidslt6<span class="op">+</span>kidsge6, <span class="dt">data=</span>mroz, <span class="dt">dist=</span><span class="st">&quot;gaussian&quot;</span>)
<span class="kw">summary</span>(res)</code></pre>
<pre><code>## 
## Call:
## survreg(formula = Surv(hours, hours &gt; 0, type = &quot;left&quot;) ~ nwifeinc + 
##     educ + exper + I(exper^2) + age + kidslt6 + kidsge6, data = mroz, 
##     dist = &quot;gaussian&quot;)
##                 Value Std. Error      z       p
## (Intercept)  965.3053   446.4361   2.16 0.03060
## nwifeinc      -8.8142     4.4591  -1.98 0.04808
## educ          80.6456    21.5832   3.74 0.00019
## exper        131.5643    17.2794   7.61 2.7e-14
## I(exper^2)    -1.8642     0.5377  -3.47 0.00053
## age          -54.4050     7.4185  -7.33 2.2e-13
## kidslt6     -894.0217   111.8780  -7.99 1.3e-15
## kidsge6      -16.2180    38.6414  -0.42 0.67470
## Log(scale)     7.0229     0.0371 189.51 &lt; 2e-16
## 
## Scale= 1122 
## 
## Gaussian distribution
## Loglik(model)= -3819.1   Loglik(intercept only)= -3954.9
##  Chisq= 271.59 on 7 degrees of freedom, p= 7e-55 
## Number of Newton-Raphson Iterations: 4 
## n= 753</code></pre>
</div>
</div>
<div id="censored-and-truncated-regression-models" class="section level2">
<h2><span class="header-section-number">2.4</span> Censored and Truncated Regression Models</h2>
<p>Censored regression models are closely related to Tobit models. In the basic Tobit model we observe <span class="math inline">\(y = y^*\)</span> in the “uncensored” cases with <span class="math inline">\(y^* &gt; 0\)</span> and we only know an upper bound for <span class="math inline">\(y^* \le 0\)</span> if we observe $y 0 = $.</p>
<p>In this example we are are interested in criminal prognosis of individuals released from prison to reoffend.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(recid, <span class="dt">package=</span><span class="st">&#39;wooldridge&#39;</span>)

<span class="co"># Define Dummy for UNcensored observations</span>
recid<span class="op">$</span>uncensored &lt;-<span class="st"> </span>recid<span class="op">$</span>cens<span class="op">==</span><span class="dv">0</span>
<span class="co"># Estimate censored regression model:</span>
res&lt;-<span class="kw">survreg</span>(<span class="kw">Surv</span>(<span class="kw">log</span>(durat),uncensored, <span class="dt">type=</span><span class="st">&quot;right&quot;</span>) <span class="op">~</span><span class="st"> </span>workprg<span class="op">+</span>priors<span class="op">+</span>
<span class="st">               </span>tserved<span class="op">+</span>felon<span class="op">+</span>alcohol<span class="op">+</span>drugs<span class="op">+</span>black<span class="op">+</span>married<span class="op">+</span>educ<span class="op">+</span>age, 
             <span class="dt">data=</span>recid, <span class="dt">dist=</span><span class="st">&quot;gaussian&quot;</span>)
<span class="co"># Output:</span>
<span class="kw">summary</span>(res)</code></pre>
<pre><code>## 
## Call:
## survreg(formula = Surv(log(durat), uncensored, type = &quot;right&quot;) ~ 
##     workprg + priors + tserved + felon + alcohol + drugs + black + 
##         married + educ + age, data = recid, dist = &quot;gaussian&quot;)
##                 Value Std. Error     z       p
## (Intercept)  4.099386   0.347535 11.80 &lt; 2e-16
## workprg     -0.062572   0.120037 -0.52  0.6022
## priors      -0.137253   0.021459 -6.40 1.6e-10
## tserved     -0.019331   0.002978 -6.49 8.5e-11
## felon        0.443995   0.145087  3.06  0.0022
## alcohol     -0.634909   0.144217 -4.40 1.1e-05
## drugs       -0.298160   0.132736 -2.25  0.0247
## black       -0.542718   0.117443 -4.62 3.8e-06
## married      0.340684   0.139843  2.44  0.0148
## educ         0.022920   0.025397  0.90  0.3668
## age          0.003910   0.000606  6.45 1.1e-10
## Log(scale)   0.593586   0.034412 17.25 &lt; 2e-16
## 
## Scale= 1.81 
## 
## Gaussian distribution
## Loglik(model)= -1597.1   Loglik(intercept only)= -1680.4
##  Chisq= 166.74 on 10 degrees of freedom, p= 1.3e-30 
## Number of Newton-Raphson Iterations: 4 
## n= 1445</code></pre>
<div id="the-heckman-or-sample-selection-model" class="section level3">
<h3><span class="header-section-number">2.4.1</span> The Heckman, or Sample Selection Model</h3>
<p>The models are useful when the sample selection is not random, but whehter an individual is in the sample depends on individual characteristics. For example, when studying wage determination for married women, some women are not in the labour force, therefore their wages are zero.</p>
<p>The Heckit procedure involves two steps, estimating both the selection equation and the equation of interest. Function <code>selection()</code> in the <strong>sampleSelection</strong> package performs both steps; therefore, it needs both equations among its arguments. (The selection equation is, in fact, a probit model.)</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">&quot;mroz&quot;</span>, <span class="dt">package=</span><span class="st">&#39;wooldridge&#39;</span>)
wage.heckit &lt;-<span class="st"> </span><span class="kw">selection</span>(inlf<span class="op">~</span>age<span class="op">+</span>educ<span class="op">+</span><span class="kw">I</span>(kidslt6<span class="op">+</span>kidsge6)<span class="op">+</span>mtr,
                         <span class="kw">log</span>(wage)<span class="op">~</span>educ<span class="op">+</span>exper, 
                         <span class="dt">data=</span>mroz, <span class="dt">method=</span><span class="st">&quot;ml&quot;</span>)
<span class="kw">summary</span>(wage.heckit)</code></pre>
<pre><code>## --------------------------------------------
## Tobit 2 model (sample selection model)
## Maximum Likelihood estimation
## Newton-Raphson maximisation, 4 iterations
## Return code 2: successive function values within tolerance limit
## Log-Likelihood: -913.5131 
## 753 observations (325 censored and 428 observed)
## 10 free parameters (df = 743)
## Probit selection equation:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           1.53798    0.61889   2.485   0.0132 *  
## age                  -0.01346    0.00603  -2.232   0.0259 *  
## educ                  0.06278    0.02180   2.879   0.0041 ** 
## I(kidslt6 + kidsge6) -0.05108    0.03276  -1.559   0.1194    
## mtr                  -2.20864    0.54620  -4.044 5.81e-05 ***
## Outcome equation:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.646221   0.235569   2.743  0.00623 ** 
## educ        0.066462   0.016573   4.010 6.68e-05 ***
## exper       0.011972   0.004085   2.931  0.00348 ** 
##    Error terms:
##       Estimate Std. Error t value Pr(&gt;|t|)    
## sigma  0.84112    0.04302   19.55   &lt;2e-16 ***
## rho   -0.82768    0.03911  -21.16   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## --------------------------------------------</code></pre>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-dalpiaz2016">
<p>Dalpiaz, David. 2016. <em>Applied Statistics</em>. <a href="http://www.stat.illinois.edu" class="uri">http://www.stat.illinois.edu</a>.</p>
</div>
<div id="ref-Adkins2014">
<p>Adkins, Lee. 2014. “Using Gretl for Principles of Econometrics, 4th Edition.” Economics Working Paper Series 1412. Oklahoma State University, Department of Economics and Legal Studies in Business. <a href="https://econpapers.repec.org/paper/oklwpaper/1412.htm" class="uri">https://econpapers.repec.org/paper/oklwpaper/1412.htm</a>.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="linearregression.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["MEM5220_R.pdf", "MEM5220_R.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
